(function(){"use strict";var e={7138:function(e,t,o){var a=o(9242),s=o(3396);function r(e,t,o,a,r,n){const l=(0,s.up)("HeaderGlobal"),i=(0,s.up)("router-view"),u=(0,s.up)("FooterGlobal");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(l),(0,s._)("div",null,[((0,s.wg)(),(0,s.j4)(i,{key:r.componentKey,onSuccess:n.success,onError:n.error,onWarning:n.warning,onForceUpdate:n.forceUpdate},{default:(0,s.w5)((({Component:e})=>[((0,s.wg)(),(0,s.j4)(s.Ob,{include:"Books"},[((0,s.wg)(),(0,s.j4)((0,s.LL)(e)))],1024))])),_:1},8,["onSuccess","onError","onWarning","onForceUpdate"]))]),(0,s.Wm)(u)],64)}var n=o(7139);const l={class:"navbar navbar-expand-lg navbar-dark bg-dark"},i={class:"container-fluid"},u=(0,s._)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,s._)("span",{class:"navbar-toggler-icon"})],-1),c={class:"collapse navbar-collapse",id:"navbarNav"},d={class:"navbar-nav me-auto mb-2 mb-lg-0"},m={class:"nav-item"},p=(0,s.Uk)("Home"),h={class:"nav-item"},b=(0,s.Uk)("Books"),v={key:0,class:"nav-item dropdown"},k=(0,s._)("a",{href:"#",class:"nav-link dropdown-toggle",id:"navBarDropDown",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Admin ",-1),g={class:"dropdown-menu","aria-labelledby":"navBarDropDown"},f=(0,s.Uk)("Manage Users"),_=(0,s.Uk)("Add User"),w=(0,s.Uk)("Books"),y=(0,s.Uk)("Add Book"),D={class:"nav-item"},C=(0,s.Uk)("Login"),$={class:"navbar-text"};function x(e,t,o,a,r,x){const U=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("nav",l,[(0,s._)("div",i,[u,(0,s._)("div",c,[(0,s._)("ul",d,[(0,s._)("li",m,[(0,s.Wm)(U,{class:"nav-link active","aria-current":"page",to:"/"},{default:(0,s.w5)((()=>[p])),_:1})]),(0,s._)("li",h,[(0,s.Wm)(U,{class:"nav-link active",to:"/books"},{default:(0,s.w5)((()=>[b])),_:1})]),""!==r.store.token?((0,s.wg)(),(0,s.iD)("li",v,[k,(0,s._)("ul",g,[(0,s._)("li",null,[(0,s.Wm)(U,{class:"dropdown-item",to:"/admin/users"},{default:(0,s.w5)((()=>[f])),_:1})]),(0,s._)("li",null,[(0,s.Wm)(U,{class:"dropdown-item",to:"/admin/users/0"},{default:(0,s.w5)((()=>[_])),_:1})]),(0,s._)("li",null,[(0,s.Wm)(U,{class:"dropdown-item",to:"/admin/books"},{default:(0,s.w5)((()=>[w])),_:1})]),(0,s._)("li",null,[(0,s.Wm)(U,{to:{name:"BookEdit",params:{bookId:0}},class:"dropdown-item"},{default:(0,s.w5)((()=>[y])),_:1})])])])):(0,s.kq)("",!0),(0,s._)("li",D,[""==r.store.token?((0,s.wg)(),(0,s.j4)(U,{key:0,class:"nav-link",to:"/login"},{default:(0,s.w5)((()=>[C])),_:1})):((0,s.wg)(),(0,s.iD)("a",{key:1,href:"javascript:void(0);",class:"nav-link",onClick:t[0]||(t[0]=(...e)=>x.logout&&x.logout(...e))},"Logout"))])]),(0,s._)("span",$,(0,n.zw)(r.store.user.first_name??""),1)])])])}var U=o(4870);const F=(0,U.qj)({token:"",user:{}});var q=o(2483),S=o.p+"img/StalkerLogo.19e8405b.jpg";const j={class:"container"},I=(0,s._)("div",{class:"rov"},[(0,s._)("div",{class:"col"},[(0,s._)("img",{src:S,alt:"Stalker Books",class:"img-fluid mt-5"})])],-1),V=[I];function O(e,t){return(0,s.wg)(),(0,s.iD)("div",j,V)}var T=o(89);const E={},B=(0,T.Z)(E,[["render",O]]);var W=B;const H={class:"container"},L={class:"rov"},A={class:"col"},z=(0,s._)("h1",{class:"mt-5"},"Login",-1),N=(0,s._)("hr",null,null,-1),P=(0,s._)("hr",null,null,-1),M=(0,s._)("input",{type:"submit",class:"btn btn-primary",value:"login"},null,-1);function R(e,t,o,a,r,n){const l=(0,s.up)("text-input"),i=(0,s.up)("form-tag");return(0,s.wg)(),(0,s.iD)("div",H,[(0,s._)("div",L,[(0,s._)("div",A,[z,N,(0,s.Wm)(i,{onMyevent:n.submitHandler,name:"myForm",event:"myevent"},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{modelValue:r.email,"onUpdate:modelValue":t[0]||(t[0]=e=>r.email=e),label:"Email",type:"email",name:"email",required:"true"},null,8,["modelValue"]),(0,s.Wm)(l,{modelValue:r.password,"onUpdate:modelValue":t[1]||(t[1]=e=>r.password=e),label:"Password",type:"password",name:"password",required:"true"},null,8,["modelValue"]),P,M])),_:1},8,["onMyevent"])])])])}const Z={class:"mb-3"},Y=["for"],G=["type","name","placeholder","required","min","max","value","autocomplete"],K={class:"form-text"};function J(e,t,o,a,r,l){return(0,s.wg)(),(0,s.iD)("div",Z,[(0,s._)("label",{for:o.name,class:"form-label"},(0,n.zw)(o.label),9,Y),(0,s._)("input",{type:o.type,name:o.name,placeholder:o.placeholder,required:o.required,min:o.min,max:o.max,value:o.modelValue,autocomplete:o.name+"-new",onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t.target.value)),class:"form-control"},null,40,G),(0,s._)("div",K,(0,n.zw)(o.help),1)])}var Q={name:"TextInput",props:{name:String,type:String,label:String,placeholder:String,required:String,min:String,max:String,modelValue:String,help:String}};const X=(0,T.Z)(Q,[["render",J]]);var ee=X;const te=["event","method","action"];function oe(e,t,o,r,n,l){return(0,s.wg)(),(0,s.iD)("form",{onSubmit:t[0]||(t[0]=(0,a.iM)(((...e)=>l.submit&&l.submit(...e)),["prevent"])),ref:o.name,event:o.event,autocomplete:"off",method:o.method,action:o.action,class:"needs-validation",novalidate:""},[(0,s.WI)(e.$slots,"default")],40,te)}var ae={name:"FormTag",props:["method","action","name","event"],methods:{submit(){let e=this.$refs[this.$props.name];e.checkValidity()&&(console.log("My event name",this.$props["event"]),console.log("Name",this.$props.name),this.$emit(this.$props["event"])),e.classList.add("was-validated")}}};const se=(0,T.Z)(ae,[["render",oe]]);var re=se,ne=o(602),le=o.n(ne);let ie={requireToken:function(){if(""===F.token)return To.push("/login"),!1},requestOptions:function(e){const t=new Headers;return t.append("Content-Type","application/json"),t.append("Authorization","Bearer "+F.token),{method:"POST",body:JSON.stringify(e),headers:t}},checkToken:function(){if(""!==F.token){const e={token:F.token},t=new Headers;t.append("Content-Type","application/json");let o={method:"POST",body:JSON.stringify(e),headers:t};fetch("http://localhost:8081/validate-token",o).then((e=>e.json())).then((e=>{e.error?console.log(e.error):e.data||(F.token="",F.user={},document.cookie="_site_data=; Path=/; SameSite=strict; Secure: Expires=Thu, 01 Jan 1970 00:00:01 GMT;")}))}}};var ue=ie,ce={name:"Login",components:{FormTag:re,TextInput:ee},data(){return{email:"",password:"",store:F,ready:!1}},methods:{submitHandler(){const e={email:this.email,password:this.password};fetch("http://localhost:8081/users/login",ue.requestOptions(e)).then((e=>e.json())).then((e=>{if(e.error)le().alert({type:"error",text:e.message});else{console.log("Token:",e.data.token.token),F.token=e.data.token.token,F.user={id:e.data.user.id,first_name:e.data.user.first_name,last_name:e.data.user.last_name,email:e.data.user.email};let t=new Date,o=1;t.setTime(t.getTime()+24*o*60*60*1e3);const a="expires="+t.toUTCString();document.cookie="_site_data="+JSON.stringify(e.data)+"; "+a+"; path/; sameSite=strict; Secure;",To.push("/")}}))}}};const de=(0,T.Z)(ce,[["render",R]]);var me=de;const pe=e=>((0,s.dD)("data-v-1270e63f"),e=e(),(0,s.Cn)(),e),he={class:"container"},be={class:"row"},ve=pe((()=>(0,s._)("div",{class:"col"},[(0,s._)("h1",{class:"mt-3"},"Books")],-1))),ke=pe((()=>(0,s._)("hr",null,null,-1))),ge={class:"filters text-center mb-2"},fe=pe((()=>(0,s._)("hr",null,null,-1))),_e={class:"card-group"},we={key:0,class:"card me-2 ms-1 mb-3",style:{width:"10rem"}},ye=["src","alt"],De={class:"card-body text-center"},Ce={class:"card-title"},$e={class:"book-author"},xe=pe((()=>(0,s._)("br",null,null,-1))),Ue={class:"me-1"},Fe=(0,s.Uk)(",");function qe(e,t,o,r,l,i){const u=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",he,[(0,s._)("div",be,[ve,ke,(0,s._)("div",ge,[(0,s._)("span",{class:(0,n.C_)(["filter me-1",{active:0===r.currentFilter}]),onClick:t[0]||(t[0]=e=>r.setFilter(0))},"ALL",2),(0,s._)("span",{class:(0,n.C_)(["filter me-1",{active:1===r.currentFilter}]),onClick:t[1]||(t[1]=e=>r.setFilter(1))},"SCIENCE FICTION",2),(0,s._)("span",{class:(0,n.C_)(["filter me-1",{active:2===r.currentFilter}]),onClick:t[2]||(t[2]=e=>r.setFilter(2))},"FANTASY",2),(0,s._)("span",{class:(0,n.C_)(["filter me-1",{active:3===r.currentFilter}]),onClick:t[3]||(t[3]=e=>r.setFilter(3))},"Romance",2),(0,s._)("span",{class:(0,n.C_)(["filter me-1",{active:4===r.currentFilter}]),onClick:t[4]||(t[4]=e=>r.setFilter(4))},"THRILLER",2),(0,s._)("span",{class:(0,n.C_)(["filter me-1",{active:5===r.currentFilter}]),onClick:t[5]||(t[5]=e=>r.setFilter(5))},"Mystery",2),(0,s._)("span",{class:(0,n.C_)(["filter me-1",{active:6===r.currentFilter}]),onClick:t[6]||(t[6]=e=>r.setFilter(6))},"HORROR",2),(0,s._)("span",{class:(0,n.C_)(["filter me-1",{active:7===r.currentFilter}]),onClick:t[7]||(t[7]=e=>r.setFilter(7))},"CLASSIC",2)]),fe,(0,s._)("div",null,[(0,s._)("div",_e,[(0,s.Wm)(a.W3,{class:"p-3 d-flex flex-wrap",tag:"div",appear:"",name:"books"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.books,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e.id},[e.genre_ids.includes(r.currentFilter)||0===r.currentFilter?((0,s.wg)(),(0,s.iD)("div",we,[(0,s.Wm)(u,{to:`/books/${e.slug}`},{default:(0,s.w5)((()=>[(0,s._)("img",{src:`${r.imgPath}/covers/${e.slug}.jpg`,class:"card-img-top",alt:`cover for ${e.title}`},null,8,ye)])),_:2},1032,["to"]),(0,s._)("div",De,[(0,s._)("h6",Ce,(0,n.zw)(e.title),1),(0,s._)("span",$e,(0,n.zw)(e.author.author_name),1),xe,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.genres,((t,o)=>((0,s.wg)(),(0,s.iD)("small",{class:"text-muted book-genre",key:t.id},[(0,s._)("em",Ue,[(0,s.Uk)((0,n.zw)(t.genre_name)+" ",1),o!==e.genres.length-1?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[Fe],64)):(0,s.kq)("",!0)])])))),128))])])):(0,s.kq)("",!0)])))),128))])),_:1})])])])])}var Se={name:"BooksComposition",emits:["error"],props:{},setup(e,t){console.log("setup");let o=(0,U.iH)(!1),a=(0,U.iH)(0);const r=(0,U.iH)("http://localhost:8081");let n=(0,U.iH)({});function l(e){a.value=e}return(0,s.bv)((()=>{fetch("http://localhost:8081/books").then((e=>e.json())).then((e=>{e.error?t.$emit("error",e.message):(n=e.data.books,console.log("books",n),o.value=!0)})).catch((e=>{t.emit("error",e)}))})),{currentFilter:a,imgPath:r,books:n,setFilter:l,ready:o}}};const je=(0,T.Z)(Se,[["render",qe],["__scopeId","data-v-1270e63f"]]);var Ie=je;const Ve={class:"container"},Oe={class:"row"},Te={class:"col-md-2"},Ee=["src","alt"],Be={class:"col-md-10"},We={class:"mt-3"},He=(0,s._)("strong",null,"Author:",-1),Le=(0,s._)("br",null,null,-1),Ae=(0,s._)("strong",null,"Published:",-1),ze=(0,s._)("hr",null,null,-1),Ne={key:1};function Pe(e,t,o,a,r,l){return(0,s.wg)(),(0,s.iD)("div",Ve,[(0,s._)("div",Oe,[(0,s._)("div",Te,[this.ready?((0,s.wg)(),(0,s.iD)("img",{key:0,class:"img-fluid img-thumbnail",src:`${this.imgPath}/covers/${r.book.slug}.jpg`,alt:`cover for ${r.book.title}`},null,8,Ee)):(0,s.kq)("",!0)]),(0,s._)("div",Be,[this.ready?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s._)("h3",We,(0,n.zw)(r.book.title),1),(0,s._)("p",null,[He,(0,s.Uk)(" "+(0,n.zw)(r.book.author.author_name)+" ",1),Le,Ae,(0,s.Uk)(" "+(0,n.zw)(r.book.publication_year),1)]),(0,s._)("p",null,(0,n.zw)(r.book.description),1),ze,(0,s._)("button",{onClick:t[0]||(t[0]=(...e)=>l.clickedDownload&&l.clickedDownload(...e))},"Download Book")],64)):((0,s.wg)(),(0,s.iD)("p",Ne,"Loading..."))])])])}var Me={name:"Book",data(){return{book:{},imgPath:"http://localhost:8081/static",ready:!1}},methods:{async clickedDownload(){const e=`${this.imgPath}/books/${this.book.book_file_name}`;try{const t=await fetch(e),o=await t.blob(),a=await URL.createObjectURL(o),s=document.createElement("a");s.href=a,s.download=`${this.book.book_file_name}`,document.body.appendChild(s),s.click(),document.body.removeChild(s)}catch(t){console.log({err:t})}}},mounted(){fetch("http://localhost:8081/books/"+this.$route.params.bookName).then((e=>e.json())).then((e=>{e.error?this.$emit("error",e.message):(this.book=e.data,this.ready=!0)}))}};const Re=(0,T.Z)(Me,[["render",Pe]]);var Ze=Re;const Ye={class:"container"},Ge={class:"row"},Ke={class:"col"},Je=(0,s._)("h1",{class:"mt-3"},"Manage Books",-1),Qe=(0,s._)("hr",null,null,-1),Xe={key:0,class:"table table-striped table-compact"},et=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"Book"),(0,s._)("th",null,"Author")])],-1);function tt(e,t,o,a,r,l){const i=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",Ye,[(0,s._)("div",Ge,[(0,s._)("div",Ke,[Je,Qe,this.ready?((0,s.wg)(),(0,s.iD)("table",Xe,[et,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.books,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",null,[(0,s.Wm)(i,{to:`/admin/books/${e.id}`},{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(e.title),1)])),_:2},1032,["to"])]),(0,s._)("td",null,(0,n.zw)(e.author.author_name),1)])))),128))])])):(0,s.kq)("",!0)])])])}var ot={name:"BookAdmin",data(){return{books:{},ready:!1}},mounted(){ue.requireToken(),fetch("http://localhost:8081/books").then((e=>e.json())).then((e=>{e.error?this.$emit("error",e.message):(this.books=e.data.books,this.ready=!0)}))}};const at=(0,T.Z)(ot,[["render",tt]]);var st=at;const rt=e=>((0,s.dD)("data-v-98204a48"),e=e(),(0,s.Cn)(),e),nt={class:"container"},lt={class:"row"},it={class:"col"},ut=rt((()=>(0,s._)("h1",{class:"mt-3"},"Add/Edit Book",-1))),ct=rt((()=>(0,s._)("hr",null,null,-1))),dt={key:0,class:"mb-3"},mt=["src"],pt={class:"mb-3"},ht=rt((()=>(0,s._)("label",{for:"formFileBook",class:"form-label"},"Cover Books",-1))),bt={class:"mb-3"},vt=rt((()=>(0,s._)("label",{for:"formFile",class:"form-label"},"Cover Image",-1))),kt={class:"mb-3"},gt=rt((()=>(0,s._)("label",{for:"description",class:"form-label"},"Description",-1))),ft={class:"mb-3"},_t=rt((()=>(0,s._)("label",{for:"genres",class:"form-label"},"Genres",-1))),wt=["value"],yt=rt((()=>(0,s._)("br",null,null,-1))),Dt=rt((()=>(0,s._)("hr",null,null,-1))),Ct={class:"float-start"},$t=rt((()=>(0,s._)("input",{type:"submit",class:"btn btn-primary me-2",value:"Save"},null,-1))),xt=(0,s.Uk)("Cancel"),Ut={class:"float-end"},Ft=rt((()=>(0,s._)("div",{class:"clearfix"},null,-1)));function qt(e,t,o,r,l,i){const u=(0,s.up)("text-input"),c=(0,s.up)("select-input"),d=(0,s.up)("router-link"),m=(0,s.up)("form-tag");return(0,s.wg)(),(0,s.iD)("div",nt,[(0,s._)("div",lt,[(0,s._)("div",it,[ut,ct,(0,s.Wm)(m,{onBookEditEvent:i.submitHandler,name:"bookForm",event:"bookEditEvent"},{default:(0,s.w5)((()=>[""!==this.book.slug?((0,s.wg)(),(0,s.iD)("div",dt,[(0,s._)("img",{src:`${this.imgPath}/covers/${this.book.slug}.jpg`,class:"img-fluid img-thumbnail book-cover",alt:"cover"},null,8,mt)])):(0,s.kq)("",!0),(0,s._)("div",pt,[ht,0===this.book.id?((0,s.wg)(),(0,s.iD)("input",{key:0,ref:"file",class:"form-control",type:"file",id:"formFileBook",onChange:t[0]||(t[0]=(...e)=>i.saveFileName&&i.saveFileName(...e)),required:""},null,544)):((0,s.wg)(),(0,s.iD)("input",{key:1,ref:"file",class:"form-control",type:"file",id:"formFileBook",onChange:t[1]||(t[1]=(...e)=>i.saveFileName&&i.saveFileName(...e))},null,544))]),(0,s._)("div",bt,[vt,0===this.book.id?((0,s.wg)(),(0,s.iD)("input",{key:0,ref:"coverInput",class:"form-control",type:"file",id:"formFile",required:"",accept:"image/jpg",onChange:t[2]||(t[2]=(...e)=>i.loadCoverImage&&i.loadCoverImage(...e))},null,544)):((0,s.wg)(),(0,s.iD)("input",{key:1,ref:"coverInput",class:"form-control",type:"file",id:"formFile",accept:"image/jpg",onChange:t[3]||(t[3]=(...e)=>i.loadCoverImage&&i.loadCoverImage(...e))},null,544))]),(0,s.Wm)(u,{modelValue:l.book.title,"onUpdate:modelValue":t[4]||(t[4]=e=>l.book.title=e),type:"text",required:"true",label:"Title",value:l.book.title,name:"title"},null,8,["modelValue","value"]),(0,s.Wm)(c,{name:"author-id",modelValue:this.book.author_id,"onUpdate:modelValue":t[5]||(t[5]=e=>this.book.author_id=e),items:this.authors,required:"required",label:"Author"},null,8,["modelValue","items"]),(0,s.Wm)(u,{modelValue:l.book.publication_year,"onUpdate:modelValue":t[6]||(t[6]=e=>l.book.publication_year=e),type:"number",required:"true",label:"Publication Year",value:l.book.publication_year,name:"publication_year"},null,8,["modelValue","value"]),(0,s._)("div",kt,[gt,(0,s.wy)((0,s._)("textarea",{required:"","onUpdate:modelValue":t[7]||(t[7]=e=>l.book.description=e),class:"form-control",id:"description",rows:"3"},null,512),[[a.nr,l.book.description]])]),(0,s._)("div",ft,[_t,(0,s.wy)((0,s._)("select",{ref:"genres",id:"genres",class:"form-select",required:"",size:"7","onUpdate:modelValue":t[8]||(t[8]=e=>this.book.genre_ids=e),multiple:""},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.genres,(e=>((0,s.wg)(),(0,s.iD)("option",{value:e.value,key:e.value},(0,n.zw)(e.text),9,wt)))),128))],512),[[a.bM,this.book.genre_ids]]),yt]),Dt,(0,s._)("div",Ct,[$t,(0,s.Wm)(d,{to:"/admin/books",class:"btn btn-outline-secondary"},{default:(0,s.w5)((()=>[xt])),_:1})]),(0,s._)("div",Ut,[this.book.id>0?((0,s.wg)(),(0,s.iD)("a",{key:0,href:"javascript:void(0);",onClick:t[9]||(t[9]=e=>i.confirmDelete(this.book.id,this.book.book_file_name)),class:"btn btn-danger"}," Delete ")):(0,s.kq)("",!0)]),Ft])),_:1},8,["onBookEditEvent"])])])])}const St={class:"mb-3"},jt=["for"],It=["id","name","required","multiple","value"],Vt=(0,s._)("option",{disabled:"",value:""},"Choose...",-1),Ot=["value"];function Tt(e,t,o,a,r,l){return(0,s.wg)(),(0,s.iD)("div",St,[(0,s._)("label",{for:o.name,class:"form-label"},(0,n.zw)(o.label),9,jt),(0,s._)("select",{id:o.name,class:"form-select",name:o.name,required:o.required,multiple:o.multiple,value:o.modelValue,onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t.target.value))},[Vt,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.items,(e=>((0,s.wg)(),(0,s.iD)("option",{value:e.value,key:e.value},(0,n.zw)(e.text),9,Ot)))),128))],40,It)])}var Et={name:"SelectInput",props:["items","name","required","label","modelValue","multiple"],emits:["update:modelValue"]};const Bt=(0,T.Z)(Et,[["render",Tt]]);var Wt=Bt,Ht=o(70),Lt={name:"BookEdit",beforeMount(){ue.requireToken(),this.$route.params.bookId>0&&fetch("http://localhost:8081/admin/books/"+this.$route.params.bookId,ue.requestOptions("")).then((e=>e.json())).then((e=>{if(e.error)this.$emit("error",e.message);else{this.book=e.data;let t=[];for(let e=0;e<this.book.genres.length;e++)t.push(this.book.genres[e].id);this.book.genre_ids=t}})),fetch("http://localhost:8081/admin/authors/all",ue.requestOptions()).then((e=>e.json())).then((e=>{e.error?this.$emit("error",e.message):this.authors=e.data}))},components:{"form-tag":re,"text-input":ee,"select-input":Wt},data(){return{book:{id:0,title:"",author_id:0,publication_year:null,description:"",cover:"",slug:"",book_file_name:"",genres:[],genre_ids:[]},authors:[],imgPath:"http://localhost:8081/static",genres:[{value:1,text:"Science Fiction"},{value:2,text:"Fantasy"},{value:3,text:"Romance"},{value:4,text:"Thriller"},{value:5,text:"Mystery"},{value:6,text:"Horror"},{value:7,text:"Classic"}]}},methods:{submitHandler(){const e={id:this.book.id,title:this.book.title,author_id:parseInt(this.book.author_id,10),publication_year:parseInt(this.book.publication_year,10),description:this.book.description,cover:this.book.cover,slug:this.book.slug,book_file_name:this.book.book_file_name,genre_ids:this.book.genre_ids},t=this.$refs.file.files[0],o=new FormData;o.append("book_file",t),Ht.Z.post("http://localhost:8081/admin/books/save-book-file",o,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+F.token}}).then((e=>{e.data.file,e.status})).then((function(){console.log("SUCCESS!!")})).catch((function(){console.log("FAILURE!!")})),fetch("http://localhost:8081/admin/books/save",ue.requestOptions(e)).then((e=>e.json())).then((e=>{console.log("data",e),e.error?this.$emit("error",e.message):(this.$emit("success","Changes saved"),To.push("/admin/books"))})).catch((e=>{this.$emit("error",e)}))},async clickedDownload(){const e=`${this.imgPath}/books/${this.book.book_file}.fb2`;try{const t=await fetch(e),o=await t.blob(),a=await URL.createObjectURL(o),s=document.createElement("a");s.href=a,s.download=`${this.book.book_file}.fb2`,document.body.appendChild(s),s.click(),document.body.removeChild(s)}catch(t){console.log({err:t})}},loadCoverImage(){const e=this.$refs.coverInput.files[0],t=new FileReader;t.onloadend=()=>{const e=t.result.replace("data:","").replace("image/jpeg;base64,","").replace(/^,+,/,"");this.book.cover=e},t.readAsDataURL(e)},confirmDelete(e,t){le().confirm({text:"Are you sure you want to delete this book?",submitText:"Delete",submitCallback:()=>{let o={id:e,book_file_name:t};fetch("http://localhost:8081/admin/books/delete",ue.requestOptions(o)).then((e=>e.json())).then((e=>{e.error?this.$emit("error",e.message):(this.$emit("success","Book deleted"),To.push("/admin/books"))}))}})},saveFileName(){this.book.book_file_name=this.$refs.file.files[0].name}}};const At=(0,T.Z)(Lt,[["render",qt],["__scopeId","data-v-98204a48"]]);var zt=At;const Nt={class:"container"},Pt={class:"row"},Mt=(0,s._)("div",{class:"col"},[(0,s._)("h1",{class:"mt-3"}," All Users ")],-1),Rt=(0,s._)("hr",null,null,-1),Zt={key:0,class:"table table-compact table-striped"},Yt=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"User"),(0,s._)("th",null,"Email"),(0,s._)("th",null,"Status"),(0,s._)("th",null,"Active")])],-1),Gt={key:0},Kt=(0,s._)("span",{class:"badge bg-success"},"Active",-1),Jt=[Kt],Qt={key:1},Xt=(0,s._)("span",{class:"badge bg-danger"},"Inactive",-1),eo=[Xt],to={key:2},oo={href:"javascript:void(0);"},ao=["onClick"],so={key:3},ro=(0,s._)("span",{class:"badge bg-danger"},"Not logged in",-1),no=[ro],lo={key:1};function io(e,t,o,a,r,l){const i=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",Nt,[(0,s._)("div",Pt,[Mt,Rt,this.ready?((0,s.wg)(),(0,s.iD)("table",Zt,[Yt,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.users,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",null,[(0,s.Wm)(i,{to:`/admin/users/${e.id}`},{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(e.last_name)+", "+(0,n.zw)(e.first_name),1)])),_:2},1032,["to"])]),(0,s._)("td",null,(0,n.zw)(e.email),1),1===e.active?((0,s.wg)(),(0,s.iD)("td",Gt,Jt)):((0,s.wg)(),(0,s.iD)("td",Qt,eo)),e.token.id>0?((0,s.wg)(),(0,s.iD)("td",to,[(0,s._)("a",oo,[(0,s._)("span",{class:"badge bg-success",onClick:t=>l.logUserOut(e.id)},"Logged in",8,ao)])])):((0,s.wg)(),(0,s.iD)("td",so,no))])))),128))])])):((0,s.wg)(),(0,s.iD)("p",lo,"Loading..."))])])}function uo(e){return new Promise((t=>setTimeout(t,e)))}var co={name:"Users",data(){return{users:[],ready:!1,store:F}},beforeMount(){ue.requireToken(),fetch("http://localhost:8081/admin/users",ue.requestOptions("")).then((e=>e.json())).then((e=>{e.error?this.$emit("error",e.message):uo(10).then((()=>{this.users=e.data.users,this.ready=!0}))})).catch((e=>{this.$emit("error",e)}))},methods:{logUserOut(e){e!==F.user.id?le().confirm({text:"Are you sure you want to log this user out",submitText:"Log Out",submitCallback:()=>{console.log("Would log out user id",e),fetch("http://localhost:8081/admin/log-user-out/"+e,ue.requestOptions("")).then((e=>e.json())).then((e=>{e.error?this.$emit("error",e.message):(this.$emit("success",e.message),this.$emit("forceUpdate"))}))}}):this.$emit("error","You can't log yourself out!")}}};const mo=(0,T.Z)(co,[["render",io]]);var po=mo;const ho={class:"container"},bo={class:"row"},vo={class:"col"},ko=(0,s._)("h1",{class:"mt-3"},"User",-1),go=(0,s._)("hr",null,null,-1),fo={class:"form-check"},_o=(0,s._)("label",{class:"form-check-lable",for:"user-active"},"Active",-1),wo={class:"form-check"},yo=(0,s._)("label",{class:"form-check-lable",for:"user-active-2"},"Inactive",-1),Do=(0,s._)("hr",null,null,-1),Co={class:"float-start"},$o=(0,s._)("input",{type:"submit",class:"btn btn-primary me-2",value:"Save"},null,-1),xo=(0,s.Uk)("Cancel"),Uo={class:"float-end"},Fo=(0,s._)("div",{class:"clearfix"},null,-1);function qo(e,t,o,r,n,l){const i=(0,s.up)("text-input"),u=(0,s.up)("router-link"),c=(0,s.up)("form-tag");return(0,s.wg)(),(0,s.iD)("div",ho,[(0,s._)("div",bo,[(0,s._)("div",vo,[ko,go,(0,s.Wm)(c,{onUserEditEvent:l.submitHandler,name:"userform",event:"userEditEvent"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{modelValue:n.user.first_name,"onUpdate:modelValue":t[0]||(t[0]=e=>n.user.first_name=e),type:"text",required:"true",label:"First Name",value:n.user.first_name,name:"first-name"},null,8,["modelValue","value"]),(0,s.Wm)(i,{modelValue:n.user.last_name,"onUpdate:modelValue":t[1]||(t[1]=e=>n.user.last_name=e),type:"text",required:"true",label:"Last Name",value:n.user.last_name,name:"last-name"},null,8,["modelValue","value"]),(0,s.Wm)(i,{modelValue:n.user.email,"onUpdate:modelValue":t[2]||(t[2]=e=>n.user.email=e),type:"email",required:"true",label:"Email",value:n.user.email,name:"email"},null,8,["modelValue","value"]),0===this.user.id?((0,s.wg)(),(0,s.j4)(i,{key:0,modelValue:n.user.password,"onUpdate:modelValue":t[3]||(t[3]=e=>n.user.password=e),type:"password",required:"true",label:"Password",value:n.user.password,name:"password"},null,8,["modelValue","value"])):((0,s.wg)(),(0,s.j4)(i,{key:1,modelValue:n.user.password,"onUpdate:modelValue":t[4]||(t[4]=e=>n.user.password=e),type:"password",label:"Password",help:"Leave empty to keep existing password",value:n.user.password,name:"password"},null,8,["modelValue","value"])),(0,s._)("div",fo,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>n.user.active=e),class:"form-check-input",type:"radio",id:"user-active",value:1},null,512),[[a.G2,n.user.active]]),_o]),(0,s._)("div",wo,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>n.user.active=e),class:"form-check-input",type:"radio",id:"user-active-2",value:0},null,512),[[a.G2,n.user.active]]),yo]),Do,(0,s._)("div",Co,[$o,(0,s.Wm)(u,{to:"/admin/users",class:"btn btn-outline-secondary"},{default:(0,s.w5)((()=>[xo])),_:1})]),(0,s._)("div",Uo,[this.$route.params.userId>0&&parseInt(String(this.$route.params.userId),10)!==n.store.user.id?((0,s.wg)(),(0,s.iD)("a",{key:0,class:"btn btn-danger",href:"javascript:void(0);",onClick:t[7]||(t[7]=e=>l.confirmDelete(this.user.id))},"Delete")):(0,s.kq)("",!0)]),Fo])),_:1},8,["onUserEditEvent"])])])])}var So={name:"UserEdit",beforeMount(){ue.requireToken(),parseInt(String(this.$route.params.userId),10)>0&&fetch("http://localhost:8081/admin/users/get/"+this.$route.params.userId,ue.requestOptions("")).then((e=>e.json())).then((e=>{e.error?this.$emit("error",e.message):(this.user=e,this.user.password="")}))},data(){return{user:{id:0,first_name:"",last_name:"",email:"",password:"",active:0},store:F,ready:!1}},components:{"form-tag":re,"text-input":ee},methods:{submitHandler(){const e={id:parseInt(String(this.$route.params.userId),10),first_name:this.user.first_name,last_name:this.user.last_name,email:this.user.email,password:this.user.password,active:this.user.active};fetch("http://localhost:8081/admin/users/save",ue.requestOptions(e)).then((e=>e.json())).then((e=>{e.error?this.$emit("error",e.message):(this.$emit("success","Changes saved!"),To.push("/admin/users"))})).catch((e=>{this.$emit("error",e)}))},confirmDelete(e){le().confirm({text:"Are you sure you want to delete this user?",submitText:"Delete",submitCallback:function(){let t={id:e};fetch("http://localhost:8081/admin/users/delete",ue.requestOptions(t)).then((e=>e.json())).then((e=>{e.error?this.$emit("error",e.message):(le().alert({type:"success",text:"User deleted"}),To.push("/admin/users"))}))}})}}};const jo=(0,T.Z)(So,[["render",qo]]);var Io=jo;const Vo=[{path:"/",name:"Home",component:W},{path:"/login",name:"Login",component:me},{path:"/book",name:"Book",component:Ze},{path:"/books",name:"BooksComposition",component:Ie},{path:"/books/:bookName",name:"Book",component:Ze},{path:"/admin/books",name:"BooksAdmin",component:st},{path:"/admin/books/:bookId",name:"BookEdit",component:zt},{path:"/admin/users",name:"Users",component:po},{path:"/admin/users/:userId",name:"User",component:Io}],Oo=(0,q.p7)({history:(0,q.PO)(),routes:Vo});Oo.beforeEach((()=>{ue.checkToken()}));var To=Oo,Eo={name:"HeaderGlobal",data(){return{store:F,ready:!1}},methods:{logout(){const e={token:F.token};fetch("http://localhost:8081/users/logout",ue.requestOptions(e)).then((e=>e.json())).then((e=>{e.error?console.log(e.message):(F.token="",F.user={},document.cookie="_site_data=; Path=/; SameSite=Strict; Secure; Expires=Thu, 01 Jan 1970 00:00:01 GMT;",To.push("/login"))}))}}};const Bo=(0,T.Z)(Eo,[["render",x]]);var Wo=Bo;const Ho={class:"d-flex align-items-center justify-content-center mt-5"};function Lo(e,t){return(0,s.wg)(),(0,s.iD)("footer",Ho," Copyright © "+(0,n.zw)((new Date).getFullYear()),1)}const Ao={},zo=(0,T.Z)(Ao,[["render",Lo],["__scopeId","data-v-705adda8"]]);var No=zo;const Po=e=>document.cookie.split("; ").reduce(((t,o)=>{const a=o.split("=");return a[0]===e?decodeURIComponent(a[1]):t}),"");var Mo={name:"App",components:{HeaderGlobal:Wo,FooterGlobal:No},data(){return{store:F,ready:!1,componentKey:0}},beforeMount(){let e=Po("_site_data");if(""!==e){let t=JSON.parse(e);F.token=t.token.token,F.user={id:t.user.id,first_name:t.user.first_name,last_name:t.user.last_name,email:t.user.email}}},methods:{success(e){le().alert({type:"success",text:e})},error(e){le().alert({type:"error",text:e})},warning(e){le().alert({type:"warning",text:e})},forceUpdate(){this.componentKey+=1}}};const Ro=(0,T.Z)(Mo,[["render",r]]);var Zo=Ro;(0,a.ri)(Zo).use(To).mount("#app")}},t={};function o(a){var s=t[a];if(void 0!==s)return s.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,o),r.exports}o.m=e,function(){var e=[];o.O=function(t,a,s,r){if(!a){var n=1/0;for(c=0;c<e.length;c++){a=e[c][0],s=e[c][1],r=e[c][2];for(var l=!0,i=0;i<a.length;i++)(!1&r||n>=r)&&Object.keys(o.O).every((function(e){return o.O[e](a[i])}))?a.splice(i--,1):(l=!1,r<n&&(n=r));if(l){e.splice(c--,1);var u=s();void 0!==u&&(t=u)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,s,r]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.p="/"}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,a){var s,r,n=a[0],l=a[1],i=a[2],u=0;if(n.some((function(t){return 0!==e[t]}))){for(s in l)o.o(l,s)&&(o.m[s]=l[s]);if(i)var c=i(o)}for(t&&t(a);u<n.length;u++)r=n[u],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(c)},a=self["webpackChunkvue_app"]=self["webpackChunkvue_app"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=o.O(void 0,[998],(function(){return o(7138)}));a=o.O(a)})();
//# sourceMappingURL=app.b545e258.js.map